<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spor Proje API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .section h2 {
            color: #555;
            margin-top: 0;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÉ‚Äç‚ôÇÔ∏è Spor Proje API Test Sayfasƒ±</h1>
        
        <div class="grid">
            <!-- Sporcular B√∂l√ºm√º -->
            <div class="section">
                <h2>üë• Sporcular</h2>
                <button onclick="getSporcular()">T√ºm Sporcularƒ± Getir</button>
                <button onclick="getAktifSporcular()">Aktif Sporcularƒ± Getir</button>
                <button onclick="getSporcuById()">ID ile Sporcu Getir</button>
                
                <div class="form-group">
                    <label>Sporcu ID:</label>
                    <input type="number" id="sporcuId" placeholder="Sporcu ID girin">
                </div>
                
                <div class="form-group">
                    <label>Spor Dalƒ±:</label>
                    <input type="text" id="sporDali" placeholder="Futbol, Basketbol, Y√ºzme">
                </div>
                <button onclick="getSporcularBySporDali()">Spor Dalƒ±na G√∂re Getir</button>
                
                <div class="form-group">
                    <h3>Yeni Sporcu Ekle</h3>
                    <label>Ad:</label>
                    <input type="text" id="sporcuAd" placeholder="Ad">
                    <label>Soyad:</label>
                    <input type="text" id="sporcuSoyad" placeholder="Soyad">
                    <label>Spor Dalƒ±:</label>
                    <input type="text" id="sporcuSporDali" placeholder="Spor Dalƒ±">
                    <label>Ya≈ü:</label>
                    <input type="number" id="sporcuYas" placeholder="Ya≈ü">
                    <label>Email:</label>
                    <input type="email" id="sporcuEmail" placeholder="Email">
                    <label>Telefon:</label>
                    <input type="text" id="sporcuTelefon" placeholder="Telefon">
                    <button onclick="addSporcu()">Sporcu Ekle</button>
                </div>
                
                <div id="sporcularResult" class="result"></div>
            </div>

            <!-- Antrenmanlar B√∂l√ºm√º -->
            <div class="section">
                <h2>üèãÔ∏è‚Äç‚ôÇÔ∏è Antrenmanlar</h2>
                <button onclick="getAntrenmanlar()">T√ºm Antrenmanlarƒ± Getir</button>
                <button onclick="getAntrenmanlarBySporcu()">Sporcuya G√∂re Antrenmanlar</button>
                
                <div class="form-group">
                    <label>Sporcu ID:</label>
                    <input type="number" id="antrenmanSporcuId" placeholder="Sporcu ID">
                </div>
                
                <div class="form-group">
                    <h3>Yeni Antrenman Ekle</h3>
                    <label>Sporcu ID:</label>
                    <input type="number" id="yeniAntrenmanSporcuId" placeholder="Sporcu ID">
                    <label>Antrenman Adƒ±:</label>
                    <input type="text" id="antrenmanAdi" placeholder="Antrenman Adƒ±">
                    <label>A√ßƒ±klama:</label>
                    <textarea id="antrenmanAciklama" placeholder="A√ßƒ±klama"></textarea>
                    <label>S√ºre (dakika):</label>
                    <input type="number" id="antrenmanSure" placeholder="S√ºre">
                    <label>Antrenman Tipi:</label>
                    <select id="antrenmanTipi">
                        <option value="Kardiyo">Kardiyo</option>
                        <option value="Kuvvet">Kuvvet</option>
                        <option value="Teknik">Teknik</option>
                        <option value="Esneklik">Esneklik</option>
                    </select>
                    <label>Kalori Yakƒ±lan:</label>
                    <input type="number" id="kaloriYakilan" placeholder="Kalori">
                    <label>Kalp Atƒ±≈ü Hƒ±zƒ±:</label>
                    <input type="number" id="kalpAtisHizi" placeholder="Kalp Atƒ±≈ü Hƒ±zƒ±">
                    <label>Notlar:</label>
                    <textarea id="antrenmanNotlar" placeholder="Notlar"></textarea>
                    <button onclick="addAntrenman()">Antrenman Ekle</button>
                </div>
                
                <div id="antrenmanlarResult" class="result"></div>
            </div>

            <!-- Performanslar B√∂l√ºm√º -->
            <div class="section">
                <h2>üìä Performanslar</h2>
                <button onclick="getPerformanslar()">T√ºm Performanslarƒ± Getir</button>
                <button onclick="getPerformanslarBySporcu()">Sporcuya G√∂re Performanslar</button>
                <button onclick="getEnIyiPerformanslar()">En ƒ∞yi Performanslar</button>
                
                <div class="form-group">
                    <h3>Yeni Performans Ekle</h3>
                    <label>Sporcu ID:</label>
                    <input type="number" id="performansSporcuId" placeholder="Sporcu ID">
                    <label>Performans Adƒ±:</label>
                    <input type="text" id="performansAdi" placeholder="Performans Adƒ±">
                    <label>Deƒüer:</label>
                    <input type="number" step="0.01" id="performansDeger" placeholder="Deƒüer">
                    <label>Birim:</label>
                    <input type="text" id="performansBirim" placeholder="Birim (saniye, kg, metre)">
                    <label>Kategori:</label>
                    <select id="performansKategori">
                        <option value="Hƒ±z">Hƒ±z</option>
                        <option value="Kuvvet">Kuvvet</option>
                        <option value="Dayanƒ±klƒ±lƒ±k">Dayanƒ±klƒ±lƒ±k</option>
                        <option value="≈ûut">≈ûut</option>
                    </select>
                    <label>A√ßƒ±klama:</label>
                    <textarea id="performansAciklama" placeholder="A√ßƒ±klama"></textarea>
                    <button onclick="addPerformans()">Performans Ekle</button>
                </div>
                
                <div id="performanslarResult" class="result"></div>
            </div>

            <!-- Beslenme B√∂l√ºm√º -->
            <div class="section">
                <h2>üçé Beslenme</h2>
                <button onclick="getBeslenmeKayitlari()">T√ºm Beslenme Kayƒ±tlarƒ±</button>
                <button onclick="getBeslenmeBySporcu()">Sporcuya G√∂re Beslenme</button>
                
                <div class="form-group">
                    <h3>Yeni Beslenme Kaydƒ± Ekle</h3>
                    <label>Sporcu ID:</label>
                    <input type="number" id="beslenmeSporcuId" placeholder="Sporcu ID">
                    <label>Yemek Adƒ±:</label>
                    <input type="text" id="yemekAdi" placeholder="Yemek Adƒ±">
                    <label>√ñƒü√ºn:</label>
                    <select id="ogun">
                        <option value="Kahvaltƒ±">Kahvaltƒ±</option>
                        <option value="√ñƒüle">√ñƒüle</option>
                        <option value="Ak≈üam">Ak≈üam</option>
                        <option value="Atƒ±≈ütƒ±rmalƒ±k">Atƒ±≈ütƒ±rmalƒ±k</option>
                    </select>
                    <label>Kalori:</label>
                    <input type="number" step="0.01" id="kalori" placeholder="Kalori">
                    <label>Protein (gram):</label>
                    <input type="number" step="0.01" id="protein" placeholder="Protein">
                    <label>Karbonhidrat (gram):</label>
                    <input type="number" step="0.01" id="karbonhidrat" placeholder="Karbonhidrat">
                    <label>Yaƒü (gram):</label>
                    <input type="number" step="0.01" id="yag" placeholder="Yaƒü">
                    <label>A√ßƒ±klama:</label>
                    <textarea id="beslenmeAciklama" placeholder="A√ßƒ±klama"></textarea>
                    <button onclick="addBeslenme()">Beslenme Kaydƒ± Ekle</button>
                </div>
                
                <div id="beslenmeResult" class="result"></div>
            </div>

            <!-- Hedefler B√∂l√ºm√º -->
            <div class="section">
                <h2>üéØ Hedefler</h2>
                <button onclick="getHedefler()">T√ºm Hedefleri Getir</button>
                <button onclick="getHedeflerBySporcu()">Sporcuya G√∂re Hedefler</button>
                <button onclick="getAktifHedefler()">Aktif Hedefler</button>
                <button onclick="getTamamlananHedefler()">Tamamlanan Hedefler</button>
                
                <div class="form-group">
                    <h3>Yeni Hedef Ekle</h3>
                    <label>Sporcu ID:</label>
                    <input type="number" id="hedefSporcuId" placeholder="Sporcu ID">
                    <label>Hedef Adƒ±:</label>
                    <input type="text" id="hedefAdi" placeholder="Hedef Adƒ±">
                    <label>A√ßƒ±klama:</label>
                    <textarea id="hedefAciklama" placeholder="A√ßƒ±klama"></textarea>
                    <label>Hedef Tarihi:</label>
                    <input type="date" id="hedefTarihi">
                    <label>Kategori:</label>
                    <select id="hedefKategori">
                        <option value="Performans">Performans</option>
                        <option value="Kilo">Kilo</option>
                        <option value="Antrenman">Antrenman</option>
                        <option value="Rekor">Rekor</option>
                    </select>
                    <label>Hedef Deƒüer:</label>
                    <input type="number" step="0.01" id="hedefDeger" placeholder="Hedef Deƒüer">
                    <label>Birim:</label>
                    <input type="text" id="hedefBirim" placeholder="Birim">
                    <button onclick="addHedef()">Hedef Ekle</button>
                </div>
                
                <div id="hedeflerResult" class="result"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:7043/api';

        // Sporcular API fonksiyonlarƒ±
        async function getSporcular() {
            try {
                const response = await fetch(`${API_BASE_URL}/Sporcu`);
                const data = await response.json();
                document.getElementById('sporcularResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sporcularResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getAktifSporcular() {
            try {
                const response = await fetch(`${API_BASE_URL}/Sporcu/Aktif`);
                const data = await response.json();
                document.getElementById('sporcularResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sporcularResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getSporcuById() {
            const id = document.getElementById('sporcuId').value;
            if (!id) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Sporcu/${id}`);
                const data = await response.json();
                document.getElementById('sporcularResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sporcularResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getSporcularBySporDali() {
            const sporDali = document.getElementById('sporDali').value;
            if (!sporDali) {
                alert('L√ºtfen spor dalƒ± girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Sporcu/SporDali/${sporDali}`);
                const data = await response.json();
                document.getElementById('sporcularResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sporcularResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function addSporcu() {
            const sporcu = {
                ad: document.getElementById('sporcuAd').value,
                soyad: document.getElementById('sporcuSoyad').value,
                sporDali: document.getElementById('sporcuSporDali').value,
                yas: parseInt(document.getElementById('sporcuYas').value),
                email: document.getElementById('sporcuEmail').value,
                telefon: document.getElementById('sporcuTelefon').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/Sporcu`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(sporcu)
                });
                const data = await response.json();
                document.getElementById('sporcularResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sporcularResult').textContent = 'Hata: ' + error.message;
            }
        }

        // Antrenmanlar API fonksiyonlarƒ±
        async function getAntrenmanlar() {
            try {
                const response = await fetch(`${API_BASE_URL}/Antrenman`);
                const data = await response.json();
                document.getElementById('antrenmanlarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('antrenmanlarResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getAntrenmanlarBySporcu() {
            const sporcuId = document.getElementById('antrenmanSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Antrenman/Sporcu/${sporcuId}`);
                const data = await response.json();
                document.getElementById('antrenmanlarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('antrenmanlarResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function addAntrenman() {
            // JWT token'ƒ± localStorage'dan al
            const authToken = localStorage.getItem('token');
            console.log('üîë Token kontrol√º:', authToken ? 'Token bulundu' : 'Token bulunamadƒ±');
            
            if (!authToken) {
                // Token yoksa, √∂nce giri≈ü yapƒ±lmasƒ± gerektiƒüini belirt
                alert('‚ùå L√ºtfen √∂nce giri≈ü yapƒ±n! Token bulunamadƒ±.');
                console.error('‚ùå Token bulunamadƒ±! localStorage:', localStorage);
                console.error('‚ùå Token bulunamadƒ±! L√ºtfen √∂nce giri≈ü yapƒ±n.');
                return;
            }

            const antrenman = {
                AntrenmanAdi: document.getElementById('antrenmanAdi').value || document.getElementById('egzersizAdi')?.value || '',
                Aciklama: document.getElementById('antrenmanAciklama').value || '',
                Sure: parseInt(document.getElementById('antrenmanSure').value || document.getElementById('sure')?.value || 0),
                AntrenmanTipi: document.getElementById('antrenmanTipi').value || document.getElementById('antrenmanTuru')?.value || '',
                KaloriYakilan: parseInt(document.getElementById('kaloriYakilan').value || 0),
                KalpAtisHizi: parseInt(document.getElementById('kalpAtisHizi').value || 0),
                Notlar: document.getElementById('antrenmanNotlar').value || document.getElementById('notlar')?.value || ''
            };

            // Validasyon
            if (!antrenman.AntrenmanAdi || antrenman.AntrenmanAdi.trim() === '') {
                alert('L√ºtfen antrenman adƒ± girin!');
                return;
            }

            // G√∂nderilecek veriyi logla
            console.log('üì§ Antrenman kayƒ±t isteƒüi:', antrenman);
            console.log('üì§ JSON:', JSON.stringify(antrenman));

            try {
                // √ñnce health check yap
                const healthUrl = `${API_BASE_URL}/Antrenman/health`;
                console.log('üîç Health check:', healthUrl);
                try {
                    const healthResponse = await fetch(healthUrl);
                    if (healthResponse.ok) {
                        const healthData = await healthResponse.json();
                        console.log('‚úÖ Backend √ßalƒ±≈üƒ±yor:', healthData);
                    } else {
                        console.warn('‚ö†Ô∏è Health check ba≈üarƒ±sƒ±z:', healthResponse.status);
                    }
                } catch (healthError) {
                    console.error('‚ùå Health check hatasƒ±:', healthError);
                    console.error('‚ùå Backend API √ßalƒ±≈ümƒ±yor olabilir!');
                }
                
                const url = `${API_BASE_URL}/Antrenman`;
                console.log('üì§ Antrenman ekleme isteƒüi:', url);
                console.log('üì§ G√∂nderilen veri:', JSON.stringify(antrenman, null, 2));
                console.log('üì§ Token var mƒ±:', authToken ? 'Evet' : 'Hayƒ±r');
                console.log('üì§ Token (ilk 20 karakter):', authToken ? authToken.substring(0, 20) + '...' : 'Yok');
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(antrenman)
                });

                console.log('üì• Response status:', response.status);
                console.log('üì• Response ok:', response.ok);
                console.log('üì• Response statusText:', response.statusText);
                console.log('üì• Response URL:', response.url);

                // 404 hatasƒ± i√ßin √∂zel kontrol
                if (response.status === 404) {
                    console.error('‚ùå API Status: 404 Not Found');
                    console.error('‚ùå API Hatasƒ±: HTTP 404: Not Found');
                    console.error('‚ùå Endpoint bulunamadƒ±:', url);
                    console.error('‚ùå L√ºtfen backend API\'nin √ßalƒ±≈ütƒ±ƒüƒ±ndan emin olun');
                    console.error('‚ùå Backend URL kontrol√º: http://localhost:7043/api/Antrenman');
                    document.getElementById('antrenmanlarResult').textContent = 'Hata: API endpoint bulunamadƒ± (404). L√ºtfen backend API\'nin √ßalƒ±≈ütƒ±ƒüƒ±ndan emin olun.';
                    alert('‚ùå API endpoint bulunamadƒ± (404).\n\nL√ºtfen:\n1. Backend API\'nin √ßalƒ±≈ütƒ±ƒüƒ±ndan emin olun (http://localhost:7043)\n2. Endpoint\'in doƒüru olduƒüunu kontrol edin\n3. Console\'daki hata mesajlarƒ±nƒ± kontrol edin');
                    return;
                }

                let data;
                try {
                    const responseText = await response.text();
                    console.log('üì• Response text:', responseText);
                    data = responseText ? JSON.parse(responseText) : {};
                    console.log('üì• Response data:', data);
                } catch (jsonError) {
                    console.error('‚ùå JSON parse hatasƒ±:', jsonError);
                    document.getElementById('antrenmanlarResult').textContent = 'Hata: JSON parse edilemedi. Response: ' + (await response.text());
                    alert('‚ùå Sunucudan ge√ßersiz yanƒ±t alƒ±ndƒ±. L√ºtfen tekrar deneyin.');
                    return;
                }

                if (!response.ok) {
                    // Hata durumu
                    const errorMessage = data.message || data.error || `HTTP ${response.status}`;
                    const fullError = data.innerException ? `${errorMessage} (Detay: ${data.innerException})` : errorMessage;
                    console.error('‚ùå Antrenman kaydetme hatasƒ±:', errorMessage);
                    console.error('‚ùå Full error data:', data);
                    document.getElementById('antrenmanlarResult').textContent = 'Hata: ' + JSON.stringify(data, null, 2);
                    alert('‚ùå Antrenman kaydedilirken hata olu≈ütu: ' + fullError);
                    return;
                }

                // Ba≈üarƒ±lƒ± durum
                console.log('‚úÖ Antrenman ba≈üarƒ±yla kaydedildi:', data);
                document.getElementById('antrenmanlarResult').textContent = JSON.stringify(data, null, 2);
                alert('‚úÖ Antrenman ba≈üarƒ±yla kaydedildi!');
                
                // Formu temizle
                if (document.getElementById('antrenmanAdi')) document.getElementById('antrenmanAdi').value = '';
                if (document.getElementById('antrenmanAciklama')) document.getElementById('antrenmanAciklama').value = '';
                if (document.getElementById('antrenmanSure')) document.getElementById('antrenmanSure').value = '';
                if (document.getElementById('kaloriYakilan')) document.getElementById('kaloriYakilan').value = '';
                if (document.getElementById('kalpAtisHizi')) document.getElementById('kalpAtisHizi').value = '';
                if (document.getElementById('antrenmanNotlar')) document.getElementById('antrenmanNotlar').value = '';
            } catch (error) {
                console.error('‚ùå Antrenman kaydetme hatasƒ±:', error);
                document.getElementById('antrenmanlarResult').textContent = 'Hata: ' + error.message;
                alert('‚ùå Antrenman kaydedilirken hata olu≈ütu: ' + error.message);
            }
        }

        // Performanslar API fonksiyonlarƒ±
        async function getPerformanslar() {
            try {
                const response = await fetch(`${API_BASE_URL}/Performans`);
                const data = await response.json();
                document.getElementById('performanslarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('performanslarResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getPerformanslarBySporcu() {
            const sporcuId = document.getElementById('performansSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Performans/Sporcu/${sporcuId}`);
                const data = await response.json();
                document.getElementById('performanslarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('performanslarResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getEnIyiPerformanslar() {
            const sporcuId = document.getElementById('performansSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Performans/EnIyi/${sporcuId}`);
                const data = await response.json();
                document.getElementById('performanslarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('performanslarResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function addPerformans() {
            const performans = {
                sporcuId: parseInt(document.getElementById('performansSporcuId').value),
                performansAdi: document.getElementById('performansAdi').value,
                deger: parseFloat(document.getElementById('performansDeger').value),
                birim: document.getElementById('performansBirim').value,
                kategori: document.getElementById('performansKategori').value,
                aciklama: document.getElementById('performansAciklama').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/Performans`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(performans)
                });
                const data = await response.json();
                document.getElementById('performanslarResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('performanslarResult').textContent = 'Hata: ' + error.message;
            }
        }

        // Beslenme API fonksiyonlarƒ±
        async function getBeslenmeKayitlari() {
            try {
                const response = await fetch(`${API_BASE_URL}/Beslenme`);
                const data = await response.json();
                document.getElementById('beslenmeResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('beslenmeResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getBeslenmeBySporcu() {
            const sporcuId = document.getElementById('beslenmeSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Beslenme/Sporcu/${sporcuId}`);
                const data = await response.json();
                document.getElementById('beslenmeResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('beslenmeResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function addBeslenme() {
            const beslenme = {
                sporcuId: parseInt(document.getElementById('beslenmeSporcuId').value),
                yemekAdi: document.getElementById('yemekAdi').value,
                ogun: document.getElementById('ogun').value,
                kalori: parseFloat(document.getElementById('kalori').value),
                protein: parseFloat(document.getElementById('protein').value),
                karbonhidrat: parseFloat(document.getElementById('karbonhidrat').value),
                yag: parseFloat(document.getElementById('yag').value),
                aciklama: document.getElementById('beslenmeAciklama').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/Beslenme`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(beslenme)
                });
                const data = await response.json();
                document.getElementById('beslenmeResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('beslenmeResult').textContent = 'Hata: ' + error.message;
            }
        }

        // Hedefler API fonksiyonlarƒ±
        async function getHedefler() {
            try {
                const response = await fetch(`${API_BASE_URL}/Hedef`);
                const data = await response.json();
                document.getElementById('hedeflerResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('hedeflerResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getHedeflerBySporcu() {
            const sporcuId = document.getElementById('hedefSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Hedef/Sporcu/${sporcuId}`);
                const data = await response.json();
                document.getElementById('hedeflerResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('hedeflerResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getAktifHedefler() {
            const sporcuId = document.getElementById('hedefSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Hedef/Aktif/${sporcuId}`);
                const data = await response.json();
                document.getElementById('hedeflerResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('hedeflerResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function getTamamlananHedefler() {
            const sporcuId = document.getElementById('hedefSporcuId').value;
            if (!sporcuId) {
                alert('L√ºtfen sporcu ID girin');
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/Hedef/Tamamlanan/${sporcuId}`);
                const data = await response.json();
                document.getElementById('hedeflerResult').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('hedeflerResult').textContent = 'Hata: ' + error.message;
            }
        }

        async function addHedef() {
            // Token'ƒ± localStorage'dan al
            const authToken = localStorage.getItem('token');
            
            if (!authToken) {
                document.getElementById('hedeflerResult').textContent = 'Hata: L√ºtfen √∂nce giri≈ü yapƒ±n!';
                alert('L√ºtfen √∂nce giri≈ü yapƒ±n!');
                return;
            }
            
            const hedef = {
                HedefAdi: document.getElementById('hedefAdi').value.trim(),
                Aciklama: document.getElementById('hedefAciklama').value.trim(),
                HedefTarihi: document.getElementById('hedefTarihi').value,
                Kategori: document.getElementById('hedefKategori').value,
                HedefDeger: document.getElementById('hedefDeger').value ? parseFloat(document.getElementById('hedefDeger').value) : null,
                Birim: document.getElementById('hedefBirim').value.trim()
            };
            
            // Validasyon
            if (!hedef.HedefAdi) {
                document.getElementById('hedeflerResult').textContent = 'Hata: L√ºtfen hedef adƒ± girin!';
                alert('L√ºtfen hedef adƒ± girin!');
                return;
            }
            
            if (!hedef.HedefTarihi) {
                document.getElementById('hedeflerResult').textContent = 'Hata: L√ºtfen hedef tarihi se√ßin!';
                alert('L√ºtfen hedef tarihi se√ßin!');
                return;
            }

            try {
                console.log('üì§ Hedef ekleniyor:', hedef);
                console.log('üì§ JSON:', JSON.stringify(hedef, null, 2));
                console.log('üì§ Token var mƒ±:', authToken ? 'Evet' : 'Hayƒ±r');
                console.log('üì§ Endpoint URL:', `${API_BASE_URL}/Hedef`);
                
                const response = await fetch(`${API_BASE_URL}/Hedef`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(hedef)
                });
                
                console.log('üì• Response status:', response.status);
                console.log('üì• Response ok:', response.ok);
                
                if (!response.ok) {
                    let errorData;
                    let responseText = '';
                    try {
                        responseText = await response.text();
                        console.error('‚ùå Response text:', responseText);
                        errorData = responseText ? JSON.parse(responseText) : { message: `HTTP ${response.status}: ${response.statusText}` };
                    } catch (e) {
                        errorData = { message: `HTTP ${response.status}: ${response.statusText}`, rawResponse: responseText };
                        console.error('‚ùå JSON parse hatasƒ±:', e);
                    }
                    console.error('‚ùå Hedef ekleme hatasƒ±:', errorData);
                    document.getElementById('hedeflerResult').textContent = 'Hata: ' + JSON.stringify(errorData, null, 2);
                    return;
                }
                
                let data;
                try {
                    const responseText = await response.text();
                    console.log('üì• Response text:', responseText);
                    data = responseText ? JSON.parse(responseText) : {};
                    console.log('üì• Response data:', data);
                } catch (jsonError) {
                    console.error('‚ùå JSON parse hatasƒ±:', jsonError);
                    document.getElementById('hedeflerResult').textContent = 'Hata: Sunucudan ge√ßersiz yanƒ±t alƒ±ndƒ±.';
                    return;
                }
                
                console.log('‚úÖ Hedef ba≈üarƒ±yla eklendi:', data);
                document.getElementById('hedeflerResult').textContent = JSON.stringify(data, null, 2);
                
                // Formu temizle
                document.getElementById('hedefAdi').value = '';
                document.getElementById('hedefAciklama').value = '';
                document.getElementById('hedefTarihi').value = '';
                document.getElementById('hedefKategori').value = '';
                document.getElementById('hedefDeger').value = '';
                document.getElementById('hedefBirim').value = '';
                document.getElementById('hedefSporcuId').value = '';
            } catch (error) {
                console.error('‚ùå Hedef ekleme hatasƒ±:', error);
                document.getElementById('hedeflerResult').textContent = 'Hata: ' + error.message;
            }
        }

        // Sayfa y√ºklendiƒüinde otomatik olarak sporcularƒ± getir
        window.onload = function() {
            getSporcular();
        };
    </script>
</body>
</html>
